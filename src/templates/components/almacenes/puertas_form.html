<div class="modal fade" id="puertasModal" tabindex="-1" aria-labelledby="puertasModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="puertasModalLabel">Asignar Puertas a Almacén</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <div class="modal-body">
                <form id="puertaForm" method="POST" action="#">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <input type="hidden" id="puertaId" name="id">

                    <div class="accordion mb-3" id="accordionPuertas">
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingPuerta">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#collapsePuerta" aria-expanded="true"
                                    aria-controls="collapsePuerta">
                                    Puerta
                                </button>
                            </h2>
                            <div id="collapsePuerta" class="accordion-collapse collapse show"
                                aria-labelledby="headingPuerta" data-bs-parent="#accordionPuertas">
                                <div class="accordion-body">
                                    <div class="mb-3">
                                        <label for="nombrePuerta" class="form-label">Nombre de la Puerta</label>
                                        <input type="text" class="form-control" id="nombrePuerta" name="nombrePuerta">
                                    </div>
                                    <div class="mb-3">
                                        <label for="estadoPuerta" class="form-label">Estado de la Puerta</label>
                                        <select class="form-control" id="estadoPuerta" name="estadoPuerta">
                                            {% for item in estadoPuertas %}
                                            <option value="{{ item.id }}">{{ item.descripcion }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <button type="button" class="btn btn-primary" id="agregarPuerta">Agregar
                                        Puerta</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="mt-4">Puertas Agregadas:</h5>
                    <ul class="list-group">No hay puertas agregadas</ul>
                    <ul id="listaPuertas" class="list-group"></ul>

                </form>
            </div>
            
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><i class="fa fa-xmark"></i> Cancelar</button>
                <button type="submit" class="btn btn-primary" form="puertaForm"><i class="fa fa-save"></i> Guardar</button>
            </div>
        </div>
    </div>
</div>

<script>
    function openPuertasModal(id = null) {
        const modalTitle = document.getElementById('puertaModalLabel');
        const puertaForm = document.getElementById('puertaForm');
        const puertaId = document.getElementById('puertaId');
        const puertaNombre = document.getElementById('puertaNombre');

        if (id) {
            modalTitle.innerText = 'Asignar Puertas';
            puertaForm.action = '/asignar_puertas/' + id;
        }

        puertaId.value = id || '';
        puertaNombre.value = nombre || '';
    }

    document.addEventListener('DOMContentLoaded', function () {
        const agregarPuertaBtn = document.getElementById('agregarPuerta');
        const listaPuertas = document.getElementById('listaPuertas');
        const nombrePuertaInput = document.getElementById('nombrePuerta');
        const estadoPuertaSelect = document.getElementById('estadoPuerta');
        agregarPuertaBtn.addEventListener('click', function () {
            const nombrePuerta = nombrePuertaInput.value.trim();
            const estadoPuerta = estadoPuertaSelect.value;

            if (nombrePuerta) {
                // Crear un nuevo elemento de lista
                const nuevaPuerta = document.createElement('li');
                nuevaPuerta.className = 'list-group-item d-flex justify-content-between align-items-center';
                nuevaPuerta.textContent = `${nombrePuerta} - ${estadoPuerta}`;

                // Agregar un botón para eliminar la puerta
                const eliminarBtn = document.createElement('button');
                eliminarBtn.className = 'btn btn-danger btn-sm';
                eliminarBtn.textContent = 'Eliminar';
                eliminarBtn.onclick = function () {
                    listaPuertas.removeChild(nuevaPuerta);
                };

                nuevaPuerta.appendChild(eliminarBtn);
                listaPuertas.appendChild(nuevaPuerta);

                // Limpiar los campos de entrada
                nombrePuertaInput.value = '';
                estadoPuertaSelect.selectedIndex = 0; // Restablecer al primer elemento
            } else {
                alert('Por favor, ingresa un nombre para la puerta.');
            }
        });
    });
</script>
